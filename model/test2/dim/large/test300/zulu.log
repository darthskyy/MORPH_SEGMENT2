INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: seed - 0
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: train - ['data2/zulu/zulu.train']
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: dev - ['data2/zulu/zulu.dev']
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: test - ['data2/zulu/zulu.test']
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: model - 'model/test2/dim/large/test300/zulu'
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: load - ''
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: bs - 20
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: epochs - 50
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: max_steps - 0
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: warmup_steps - 4000
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: total_eval - -1
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: optimizer - <Optimizer.adam: 'adam'>
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: scheduler - <Scheduler.reducewhenstuck: 'reducewhenstuck'>
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: lr - 0.001
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: min_lr - 1e-05
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: momentum - 0.9
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: beta1 - 0.9
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: beta2 - 0.999
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: estop - 1e-08
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: cooldown - 0
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: patience - 0
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: discount_factor - 0.5
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: max_norm - 5.0
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: gpuid - [0]
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: loglevel - 'info'
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: saveall - False
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: shuffle - False
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: cleanup_anyway - True
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: dataset - <Data.g2p: 'g2p'>
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: max_seq_len - 128
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: max_decode_len - 128
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: decode_beam_size - 5
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: init - ''
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: dropout - 0.5
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: embed_dim - 300
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: nb_heads - 4
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: src_layer - 2
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: trg_layer - 1
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: src_hs - 400
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: trg_hs - 400
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: label_smooth - 0.0
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: tie_trg_embed - False
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: arch - <Arch.hard: 'hard'>
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: nb_sample - 4
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: wid_siz - 11
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: indtag - False
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: decode - <Decode.greedy: 'greedy'>
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: mono - False
INFO - 11/07/22 00:07:12 - 0:00:00 - command line argument: bestacc - False
INFO - 11/07/22 00:07:12 - 0:00:00 - src vocab size 70
INFO - 11/07/22 00:07:12 - 0:00:00 - trg vocab size 58
INFO - 11/07/22 00:07:12 - 0:00:00 - src vocab ['<PAD>', '<BOS>', '<EOS>', '<UNK>', '"', '%', "'", ',', '.', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z']
INFO - 11/07/22 00:07:12 - 0:00:00 - trg vocab ['<PAD>', '<BOS>', '<EOS>', '<UNK>', '"', '%', "'", ',', '-', '.', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'G', 'K', 'M', 'N', 'P', 'S', 'T', 'V', 'X', 'Z', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z']
INFO - 11/07/22 00:07:12 - 0:00:00 - model: HardAttnTransducer(
                                       (src_embed): Embedding(70, 300, padding_idx=0)
                                       (trg_embed): Embedding(58, 300, padding_idx=0)
                                       (enc_rnn): LSTM(300, 400, num_layers=2, dropout=0.5, bidirectional=True)
                                       (dec_rnn): StackedLSTM(
                                         (layers): ModuleList(
                                           (0): LSTMCell(300, 400)
                                         )
                                         (dropout): Dropout(p=0.5, inplace=False)
                                       )
                                       (scale_enc_hs): Linear(in_features=800, out_features=400, bias=True)
                                       (attn): Attention()
                                       (linear_out): Linear(in_features=1200, out_features=1200, bias=True)
                                       (final_out): Linear(in_features=1200, out_features=58, bias=True)
                                       (dropout): Dropout(p=0.5, inplace=False)
                                     )
INFO - 11/07/22 00:07:12 - 0:00:00 - number of parameter 9085658
INFO - 11/07/22 00:07:14 - 0:00:02 - maximum training 21200 steps (50 epochs)
INFO - 11/07/22 00:07:14 - 0:00:02 - evaluate every 1 epochs
INFO - 11/07/22 00:07:14 - 0:00:02 - At 0-th epoch with lr 0.001000.
INFO - 11/07/22 00:07:29 - 0:00:17 - Running average train loss is 0.6331348312702382 at epoch 0
INFO - 11/07/22 00:07:29 - 0:00:17 - At 1-th epoch with lr 0.001000.
INFO - 11/07/22 00:07:42 - 0:00:30 - Running average train loss is 0.24580842564058192 at epoch 1
INFO - 11/07/22 00:07:43 - 0:00:31 - Average dev loss is 0.14439180144108832 at epoch 1
INFO - 11/07/22 00:07:43 - 0:00:32 - dev accuracy is 57.9957 at epoch 1
INFO - 11/07/22 00:07:43 - 0:00:32 - dev phenome error rate is 0.093 at epoch 1
INFO - 11/07/22 00:07:44 - 0:00:32 - At 2-th epoch with lr 0.001000.
INFO - 11/07/22 00:07:57 - 0:00:45 - Running average train loss is 0.19194147043492435 at epoch 2
INFO - 11/07/22 00:07:57 - 0:00:46 - Average dev loss is 0.12420486534635226 at epoch 2
INFO - 11/07/22 00:07:59 - 0:00:47 - dev accuracy is 64.0725 at epoch 2
INFO - 11/07/22 00:07:59 - 0:00:47 - dev phenome error rate is 0.1104 at epoch 2
INFO - 11/07/22 00:07:59 - 0:00:47 - At 3-th epoch with lr 0.001000.
INFO - 11/07/22 00:08:12 - 0:01:00 - Running average train loss is 0.16081244392179936 at epoch 3
INFO - 11/07/22 00:08:12 - 0:01:01 - Average dev loss is 0.11012199491960928 at epoch 3
INFO - 11/07/22 00:08:13 - 0:01:02 - dev accuracy is 68.4435 at epoch 3
INFO - 11/07/22 00:08:13 - 0:01:02 - dev phenome error rate is 0.088 at epoch 3
INFO - 11/07/22 00:08:14 - 0:01:02 - At 4-th epoch with lr 0.001000.
INFO - 11/07/22 00:08:27 - 0:01:15 - Running average train loss is 0.14148311514653406 at epoch 4
INFO - 11/07/22 00:08:27 - 0:01:16 - Average dev loss is 0.1030766361412437 at epoch 4
INFO - 11/07/22 00:08:28 - 0:01:17 - dev accuracy is 69.0832 at epoch 4
INFO - 11/07/22 00:08:28 - 0:01:17 - dev phenome error rate is 0.0711 at epoch 4
INFO - 11/07/22 00:08:29 - 0:01:17 - At 5-th epoch with lr 0.001000.
INFO - 11/07/22 00:08:42 - 0:01:30 - Running average train loss is 0.13018752699542158 at epoch 5
INFO - 11/07/22 00:08:42 - 0:01:31 - Average dev loss is 0.1023605140314127 at epoch 5
INFO - 11/07/22 00:08:43 - 0:01:31 - dev accuracy is 71.322 at epoch 5
INFO - 11/07/22 00:08:43 - 0:01:31 - dev phenome error rate is 0.0688 at epoch 5
INFO - 11/07/22 00:08:44 - 0:01:32 - At 6-th epoch with lr 0.001000.
INFO - 11/07/22 00:08:57 - 0:01:45 - Running average train loss is 0.11571720415585728 at epoch 6
INFO - 11/07/22 00:08:57 - 0:01:46 - Average dev loss is 0.09155844936807019 at epoch 6
INFO - 11/07/22 00:08:58 - 0:01:47 - dev accuracy is 74.2004 at epoch 6
INFO - 11/07/22 00:08:58 - 0:01:47 - dev phenome error rate is 0.0575 at epoch 6
INFO - 11/07/22 00:08:59 - 0:01:47 - At 7-th epoch with lr 0.001000.
INFO - 11/07/22 00:09:12 - 0:02:00 - Running average train loss is 0.10674867077010139 at epoch 7
INFO - 11/07/22 00:09:12 - 0:02:01 - Average dev loss is 0.0893646628537681 at epoch 7
INFO - 11/07/22 00:09:13 - 0:02:01 - dev accuracy is 72.6013 at epoch 7
INFO - 11/07/22 00:09:13 - 0:02:01 - dev phenome error rate is 0.0586 at epoch 7
INFO - 11/07/22 00:09:13 - 0:02:02 - At 8-th epoch with lr 0.001000.
INFO - 11/07/22 00:09:27 - 0:02:15 - Running average train loss is 0.10007052672675477 at epoch 8
INFO - 11/07/22 00:09:27 - 0:02:15 - Average dev loss is 0.0916514418446847 at epoch 8
INFO - 11/07/22 00:09:28 - 0:02:16 - dev accuracy is 74.4136 at epoch 8
INFO - 11/07/22 00:09:28 - 0:02:16 - dev phenome error rate is 0.0604 at epoch 8
INFO - 11/07/22 00:09:28 - 0:02:17 - At 9-th epoch with lr 0.000500.
INFO - 11/07/22 00:09:42 - 0:02:30 - Running average train loss is 0.06914718209695563 at epoch 9
INFO - 11/07/22 00:09:42 - 0:02:30 - Average dev loss is 0.0779951242050932 at epoch 9
INFO - 11/07/22 00:09:43 - 0:02:31 - dev accuracy is 78.3582 at epoch 9
INFO - 11/07/22 00:09:43 - 0:02:31 - dev phenome error rate is 0.0487 at epoch 9
INFO - 11/07/22 00:09:43 - 0:02:31 - At 10-th epoch with lr 0.000500.
INFO - 11/07/22 00:09:56 - 0:02:45 - Running average train loss is 0.0541881599687567 at epoch 10
INFO - 11/07/22 00:09:57 - 0:02:45 - Average dev loss is 0.07782085936923977 at epoch 10
INFO - 11/07/22 00:09:58 - 0:02:46 - dev accuracy is 79.9574 at epoch 10
INFO - 11/07/22 00:09:58 - 0:02:46 - dev phenome error rate is 0.044 at epoch 10
INFO - 11/07/22 00:09:58 - 0:02:46 - At 11-th epoch with lr 0.000500.
INFO - 11/07/22 00:10:11 - 0:03:00 - Running average train loss is 0.049676747072294775 at epoch 11
INFO - 11/07/22 00:10:12 - 0:03:00 - Average dev loss is 0.08037989610844913 at epoch 11
INFO - 11/07/22 00:10:13 - 0:03:01 - dev accuracy is 78.7846 at epoch 11
INFO - 11/07/22 00:10:13 - 0:03:01 - dev phenome error rate is 0.053 at epoch 11
INFO - 11/07/22 00:10:13 - 0:03:01 - At 12-th epoch with lr 0.000250.
INFO - 11/07/22 00:10:26 - 0:03:14 - Running average train loss is 0.03898038751476462 at epoch 12
INFO - 11/07/22 00:10:27 - 0:03:15 - Average dev loss is 0.0746292603459248 at epoch 12
INFO - 11/07/22 00:10:28 - 0:03:16 - dev accuracy is 80.8102 at epoch 12
INFO - 11/07/22 00:10:28 - 0:03:16 - dev phenome error rate is 0.0498 at epoch 12
INFO - 11/07/22 00:10:28 - 0:03:16 - At 13-th epoch with lr 0.000250.
INFO - 11/07/22 00:10:41 - 0:03:29 - Running average train loss is 0.03421294436249706 at epoch 13
INFO - 11/07/22 00:10:42 - 0:03:30 - Average dev loss is 0.07518015781109473 at epoch 13
INFO - 11/07/22 00:10:42 - 0:03:31 - dev accuracy is 81.6631 at epoch 13
INFO - 11/07/22 00:10:42 - 0:03:31 - dev phenome error rate is 0.041 at epoch 13
INFO - 11/07/22 00:10:43 - 0:03:31 - At 14-th epoch with lr 0.000125.
INFO - 11/07/22 00:10:56 - 0:03:44 - Running average train loss is 0.029615403311151377 at epoch 14
INFO - 11/07/22 00:10:56 - 0:03:45 - Average dev loss is 0.07169709824089902 at epoch 14
INFO - 11/07/22 00:10:57 - 0:03:45 - dev accuracy is 81.9829 at epoch 14
INFO - 11/07/22 00:10:57 - 0:03:45 - dev phenome error rate is 0.041 at epoch 14
INFO - 11/07/22 00:10:57 - 0:03:46 - At 15-th epoch with lr 0.000125.
INFO - 11/07/22 00:11:11 - 0:03:59 - Running average train loss is 0.026772455103642675 at epoch 15
INFO - 11/07/22 00:11:11 - 0:03:59 - Average dev loss is 0.07196774841304432 at epoch 15
INFO - 11/07/22 00:11:12 - 0:04:00 - dev accuracy is 82.4094 at epoch 15
INFO - 11/07/22 00:11:12 - 0:04:00 - dev phenome error rate is 0.0397 at epoch 15
INFO - 11/07/22 00:11:12 - 0:04:00 - At 16-th epoch with lr 0.000063.
INFO - 11/07/22 00:11:25 - 0:04:13 - Running average train loss is 0.024134451601399494 at epoch 16
INFO - 11/07/22 00:11:26 - 0:04:14 - Average dev loss is 0.07105573747533829 at epoch 16
INFO - 11/07/22 00:11:27 - 0:04:15 - dev accuracy is 82.1962 at epoch 16
INFO - 11/07/22 00:11:27 - 0:04:15 - dev phenome error rate is 0.0411 at epoch 16
INFO - 11/07/22 00:11:27 - 0:04:15 - At 17-th epoch with lr 0.000063.
INFO - 11/07/22 00:11:40 - 0:04:28 - Running average train loss is 0.02224638861689699 at epoch 17
INFO - 11/07/22 00:11:40 - 0:04:28 - Average dev loss is 0.07140440713783391 at epoch 17
INFO - 11/07/22 00:11:41 - 0:04:29 - dev accuracy is 82.0896 at epoch 17
INFO - 11/07/22 00:11:41 - 0:04:29 - dev phenome error rate is 0.0407 at epoch 17
INFO - 11/07/22 00:11:42 - 0:04:31 - At 18-th epoch with lr 0.000031.
INFO - 11/07/22 00:11:55 - 0:04:44 - Running average train loss is 0.02277076010205695 at epoch 18
INFO - 11/07/22 00:11:56 - 0:04:44 - Average dev loss is 0.07175691757402092 at epoch 18
INFO - 11/07/22 00:11:57 - 0:04:45 - dev accuracy is 82.516 at epoch 18
INFO - 11/07/22 00:11:57 - 0:04:45 - dev phenome error rate is 0.0403 at epoch 18
INFO - 11/07/22 00:11:57 - 0:04:45 - At 19-th epoch with lr 0.000016.
INFO - 11/07/22 00:12:10 - 0:04:58 - Running average train loss is 0.02107604405593417 at epoch 19
INFO - 11/07/22 00:12:10 - 0:04:59 - Average dev loss is 0.07110991950351793 at epoch 19
INFO - 11/07/22 00:12:11 - 0:05:00 - dev accuracy is 82.6226 at epoch 19
INFO - 11/07/22 00:12:11 - 0:05:00 - dev phenome error rate is 0.0394 at epoch 19
INFO - 11/07/22 00:12:12 - 0:05:00 - At 20-th epoch with lr 0.000010.
INFO - 11/07/22 00:12:25 - 0:05:13 - Running average train loss is 0.020552538339716365 at epoch 20
INFO - 11/07/22 00:12:25 - 0:05:13 - Average dev loss is 0.07141968455046784 at epoch 20
INFO - 11/07/22 00:12:26 - 0:05:14 - dev accuracy is 82.1962 at epoch 20
INFO - 11/07/22 00:12:26 - 0:05:14 - dev phenome error rate is 0.0401 at epoch 20
INFO - 11/07/22 00:12:26 - 0:05:14 - Early stopping triggered with epoch 20 (previous dev loss: 0.071110, current: 0.071420)
INFO - 11/07/22 00:12:26 - 0:05:14 - loading model/test2/dim/large/test300/zulu.nll_0.0711.acc_82.6226.per_0.0394.epoch_19 for testing
INFO - 11/07/22 00:12:26 - 0:05:14 - load model in model/test2/dim/large/test300/zulu.nll_0.0711.acc_82.6226.per_0.0394.epoch_19
INFO - 11/07/22 00:12:26 - 0:05:15 - Average dev loss is 0.07110992321910696 at epoch -1
INFO - 11/07/22 00:12:26 - 0:05:15 - decoding dev set
INFO - 11/07/22 00:12:28 - 0:05:16 - finished decoding 941 dev instance
INFO - 11/07/22 00:12:28 - 0:05:16 - DEV accuracy is 82.6226 at epoch -1
INFO - 11/07/22 00:12:28 - 0:05:16 - DEV phenome error rate is 0.0394 at epoch -1
INFO - 11/07/22 00:12:28 - 0:05:16 - DEV zulu acc 82.6226 per 0.0394
INFO - 11/07/22 00:12:29 - 0:05:18 - Average test loss is 0.2963425487279892 at epoch -1
INFO - 11/07/22 00:12:29 - 0:05:18 - decoding test set
INFO - 11/07/22 00:12:34 - 0:05:23 - finished decoding 3297 test instance
INFO - 11/07/22 00:12:34 - 0:05:23 - TEST accuracy is 57.5317 at epoch -1
INFO - 11/07/22 00:12:34 - 0:05:23 - TEST phenome error rate is 0.1016 at epoch -1
INFO - 11/07/22 00:12:34 - 0:05:23 - TEST zulu acc 57.5317 per 0.1016
